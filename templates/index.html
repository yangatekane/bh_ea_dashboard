<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BH-EA | Borehole Analytics Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <header>
    <h1>Borehole Exploration / Surveying Analytics (BH-EA)</h1>
    <h3>Cloud Run Impact Dashboard</h3>
  </header>

  <section id="upload">
    <form method="POST" enctype="multipart/form-data">
      <div class="row">
        <label>Upload BH-EA CSV dataset:</label>
        <input type="file" name="file" accept=".csv">
      </div>
      <div class="row">
        <label>Upload ERT-I raw data (.dat / .xyz / .csv grid):</label>
        <input type="file" name="ert_data" accept=".dat,.xyz,.csv">
      </div>
      <div class="row">
        <label>Upload ERT-I image (.png / .jpg):</label>
        <input type="file" name="ert_image" accept=".png,.jpg,.jpeg">
      </div>
      <button type="submit">Upload & Refresh</button>
    </form>
    {% if message %}<p class="message">{{ message }}</p>{% endif %}
  </section>

  <section id="kpis">
    <div class="card"><h2>{{ total_bh }}</h2><p>Boreholes Analyzed</p></div>
    <div class="card"><h2>{{ avg_yield }} L/s</h2><p>Average Yield</p></div>
    <div class="card"><h2>${{ avg_cost }}</h2><p>Average Cost</p></div>
    <div class="card"><h2>${{ proj_savings }}</h2><p>Projected Annual Savings (25%)</p></div>
  </section>

  <section id="graph">{{ plot_html | safe }}</section>

  {% if ert_processed_img_url %}
    <section id="ert">
      <h3>ERT Inversion / Pseudo-Section</h3>
      <img src="{{ ert_processed_img_url }}" alt="ERT Result" style="max-width:80%; border-radius:10px;">
      {% if ert_processed_csv_url %}
        <p><a href="{{ ert_processed_csv_url }}">Download ERT model CSV</a></p>
      {% endif %}
    </section>
  {% elif ert_uploaded_img_url %}
    <section id="ert">
      <h3>ERT-I Image Preview</h3>
      <img src="{{ ert_uploaded_img_url }}" alt="ERT Upload" style="max-width:80%; border-radius:10px;">
    </section>
  {% endif %}

  <footer>
    <p>Powered by Google Cloud Run | YGE BHI (Pty) Ltd Â© 2025</p>
  </footer>
</body>
</html>
